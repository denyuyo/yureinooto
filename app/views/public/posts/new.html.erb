<div class="container" style="margin-top: 33px; margin-bottom: 22px; font-family: 'Monomaniac One', sans-serif;">
  <h3 style="font-size: 33px;">つぶやく</h3>
  
  <!-- タグ作成フォーム -->
  <div class="col-8 mx-auto form-group" id="new-tag-form" style="display: none; position: absolute; top: 30%; left: 50%; transform: translate(-50%, -50%); background-color: rgba(0, 0, 0, 0.6); padding: 30px; z-index: 9999;">
    <table class="table table-borderless">
        <tr>
          <td>
            <%= form_with model: @tag, class: "form-inline", local: false do |f| %>
              <%= f.text_field :tag_name, placeholder: "新しいタグ", class: "form-control mr-2", style: "width: 70%" %>
              <%= f.submit "作成", class:"btn btn-primary", style: "width: 25%" %><br>
            <% end %>
          </td>
        </tr>
    </table>
  </div>

  <!-- ポスト作成フォーム -->
  <%= form_for(@post, html: { class: 'form' }) do |f| %>
    <div class="form-group">
      <%= f.label :title, style: "font-family: 'Monomaniac One', sans-serif;" %>
      <div class="col-sm-6">
        <%= f.text_field :title, class: 'form-control', style: "font-family: 'Monomaniac One', sans-serif;" %>
      </div>
    </div>

    <div class="form-group">
      <%= f.label :content, style: "font-family: 'Monomaniac One', sans-serif;" %>
      <div class="col-sm-6">
        <%= f.text_area :content, class: 'form-control', style: "font-family: 'Monomaniac One', sans-serif;" %>
      </div>
    </div>
    
    <div class="form-group">
      <%= f.label :tags, style: "font-family: 'Monomaniac One', sans-serif;" %>
      <div class="col-sm-6">
        <%= f.collection_select :tag_ids, Tag.all, :id, :tag_name, { prompt: "タグを選ぶ" }, { multiple: true, class: 'form-control' } %>
        <br>
        <%= link_to "ぴったりなタグがない?", "", id: "new-tag-link", class: "btn btn-secondary" %>
      </div>
    </div>

    <div class="text-align: right;">
      <%= f.submit "つぶやく", class: 'btn btn-primary button-depress', style: "font-family: 'Monomaniac One', sans-serif;" %>
      <%= link_to posts_path, class: 'btn btn-secondary button-depress', style: "font-family: 'Monomaniac One', sans-serif;" do %>
        <i class="fas fa-undo-alt"></i>
      <% end %>
    </div>
  <% end %>
</div>

</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const newTagForm = document.getElementById("new-tag-form");
    const newTagLink = document.getElementById("new-tag-link");

    newTagLink.addEventListener("click", function (e) {
      e.preventDefault();
      newTagForm.style.display = "block";
    });

    document.addEventListener("click", function (e) {
      if (!newTagForm.contains(e.target) && e.target !== newTagLink) {
        newTagForm.style.display = "none";
      }
    });
  });
</script>
